aln particle nanoswarm.corridor.v1

  field shardid       string
  field moduletype    string    -- e.g. Nanoswarm-PHX-Canal-2026-v1
  field region        string    -- e.g. Phoenix-AZ
  field simorlive     string    -- "sim" | "live"
  field timestamputc  string
  field didsignature  string

  table corridors
    field varid                string
    field units                string
    field safe                 f64      -- upper edge of safe band (0–1)
    field gold                 f64      -- upper edge of gold band (0–1)
    field hard                 f64      -- hard limit, must be <= 1.0
    field weightw              f64      -- w_j in V_t = Σ w_j r_j
    field lyapchannel          u8
    field mandatory            bool
  end

  field knowledgefactor01      f64
  field ecoimpact01            f64
  field riskofharm01           f64
  field violationresidual      f64      -- last known V_t that violated a band, 0.0 if none

end

-- CI contract: no corridor, no build
contract corridor_present m
  -- m is nanoswarm.corridor.v1
  -- Require that all mandatory corridors needed by nanoswarm-safety-kernel exist.
  let required = ["TDI", "MBI", "EcoImpactScore", "RadiationIndex"]
  for each r in required
    let found = any row in m.corridors where row.varid == r and row.mandatory == true
    assert found, "missing mandatory nanoswarm corridor: " + r
  end
end
